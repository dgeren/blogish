<%- include('functions'); %>
<% 
const {
  css,
  type,
  css2 = null,
  script = null,
  errorMsg = null,
  blank,
} = pageDetails;

%>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blogish</title>
  <link rel="stylesheet" href="/styles/global.css">
  <link rel="stylesheet" href="/styles/<%- css %>.css">
  <% if(css2){ %>
  <link rel="stylesheet" href="/styles/<%- css2 %>.css">
  <% } %>
  <script type="text/javascript">
    window.onpageshow = function(event) {
      if (event.persisted) {
        window.location.reload();
      }
    };
</script>
</head>

<body>
  <header>
    <div class="sijil">
      <h2 class="tagline1">The Making of</h2>
      <h1 class="xlarge"><a href="/">Sijil</a></h1>
      <div id="tagline-box">
        <label for="nav-toggle" class="nav-toggle-label">â‰¡</label>
        <h2 class="tagline2">A Career-Change Misadventure</h2>
      </div>
    </div>
    
    <input type="checkbox" id="nav-toggle" class="nav-toggle" checked>

    <nav>
      <ul class="nav">
        <% if(user) { %>
        <li class="label"><a href="/listUnpublished">UNPUBLISHED</a></li>
        <li class="label" id="editorBtn"><a href="/editor">EDITOR</a></li>
        <li class="label"><a href="/admin">ADMIN</a></li>
        <% } %>
        <%- buildAdhocList(adhocPages) %>
        
      </ul>

      <%- buildContributors(contributors); %>
      <%- buildTopics(topics); %>
      <%- buildArchive(archive); %>
      <div id="login-state" class="login-state">
        <% if(user) { %>
          <p id="logged-in-as" class="small"><%= user.email %><br> [ <a href="/logout">Log Out</a> ]</p>
        <% } else { %>
          <a id="signin-form-toggle" class="signin-form-toggle" href="">&nbsp;&#8680;]&nbsp; Login</a>
        <% } %>
        <form id="signin-form" class="signin-form" style="display: none;">
          <input class="signin-el" type="text" name="email" placeholder="Email address" required>
          <br>
          <input class="signin-el" type="password" name="password" placeholder="Password" required>
          <br>
          <button class="signin-el login">Log in </button>
          <p id="loginError" class="loginError">Unrecognized credentials. Try again.</p>
        </form>
      </div>
    </nav>
  </header>
  
  <main>
    <%- include(type); %>
  </main>

  <footer class="footer">
    <p class="small">Copyright &copy; 2021-2023 David Geren</p>
  </footer>

  <% if(script) { %>
    <script src="/scripts/<%= script %>.js"></script>
  <% } %>
  
  <% if(!user){ %>
  <script src="/scripts/login.js"></script>
  <script src="/scripts/interface.js"></script>
  <% } %>
</body>
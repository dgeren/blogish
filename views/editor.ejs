<%- include('partials/header'); -%>
<% const { title, subtitle, content, tags, published, author, id } = post; %>
<% const tagString = tags.join(", "); %>

    <div class="headings">
      <h3>Editor</h3>
    </div>
  </header>
  <main>
    <hr>
    <form>
      <%- include('partials/editorToolBar'); -%>
      <div class="message" name="message" id="message"></div>
      <section class="editor"
        <div class="element container">
          <label for="title">Title</label>
          <input type="text" name="title" class="form-el" id="title"
          <% if(title) { %>value="<%= title %>" <% } %> autofocus required>
        </div>

        <div class="element container">
          <label for="subtitle">Subtitle</label>
          <input type="text" name="subtitle" class="form-el" id="subtitle"
          <% if(subtitle) { %>value="<%= subtitle %>" <% } %>>
        </div>

        <div class="element container">
          <label for="content">Content</label>
          <textarea id="content-editor" name="content" class="form-el" id="content" required><% if(content) { %><%= content %><% } %></textarea>
        </div>

        <div class="element container">
          <label for="tags">Tags</label>
          <input type="text" name="tags" class="form-el" id="tags"
          <% if(tags) { %>value="<%= tagString %>" <% } %>>
        </div>

        <div class="element container">
          <label for="published">Publish?</label>
          <input type="checkbox" name="published" class="form-el" id="published"
          <% if(published) { %>checked<% } %>>
        </div>
        
        <input type="hidden" name="authorID" class="form-el" id="authorID" value="<%= user.id %>">
        <input type="hidden" name="postID" class="form-el" id="postID" value="<%= id %>"
      </section>
      <a href="#preview"></a>
      <%- include('partials/editorToolBar'); -%>
      <section class="preview">
        <h4><%= post.title %></h4>
        <h5><%= post.subtitle %></h5>
        <div><%- post.preview %></div>
        <div>
          <% const tagHTML = []; %>
          <% post.tags.forEach(tag => { %>
          <%   tagHTML.push(`<a href="/tag/${tag}">${tag}</a>`); %>
          <% }); %>
          <%- tagHTML.join(', '); %>
        </div>
      </section>

      <a href="#reader">
      <section class="reader">
        <h4><%= post.title %></h4>
        <h5><%= post.subtitle %></h5>
        <div class="pubDate"><%= post.pubDate %></div>
        <div><%- post.content %></div>
        <div>
          <%- tagHTML.join(', '); %>
        </div>
      </section>

      <%- include('partials/editorToolBar'); -%>
    </form>
    <hr>
  </main>

  <!-- <script src="/scripts/savePost.js"></script> -->
  <script src="/scripts/editorForm.js"></script>

<%- include('partials/footer'); -%>